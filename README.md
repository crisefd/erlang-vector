I do not own this code, the original implementation was found here:
http://pastie.org/4715345
